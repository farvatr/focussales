
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Sales Focus</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { background: #2C003E; color: white; font-family: sans-serif; padding: 20px; }
    .card { background: #3E0D5E; padding: 15px; border-radius: 12px; margin-bottom: 20px; }
    .buttons button { background: #933DC9; color: white; border: none; padding: 6px 12px; margin: 4px; border-radius: 6px; }
    input[type=number] { width: 40%; padding: 4px; border-radius: 4px; }
  </style>
</head>
<body>
  <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="username"></span></h2>

  <div style="margin-bottom: 1rem;">
    <button onclick="showTab('main')" style="margin-right:10px;">–°–µ–≥–æ–¥–Ω—è</button>
    <button onclick="showTab('analytics')">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
  </div>

  <div id="mainTab">
    <div class="card">
      <div>üìû –ó–≤–æ–Ω–∫–∏: <span id="calls">0</span> / <span id="callsGoal">70</span></div>
      <div class="buttons">
        <button onclick="change('calls', 1)">+ –ó–≤–æ–Ω–æ–∫</button>
        <button onclick="change('calls', -1)">‚Äì –ó–≤–æ–Ω–æ–∫</button>
        <div>
          <input type="number" id="input-calls" />
          <button onclick="applyInput('calls')">–í–≤–æ–¥</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div>üì≤ –î–æ–∑–≤–æ–Ω—ã: <span id="reached">0</span> / <span id="reachedGoal">25</span></div>
      <div class="buttons">
        <button onclick="change('reached', 1)">+ –î–æ–∑–≤–æ–Ω</button>
        <button onclick="change('reached', -1)">‚Äì –î–æ–∑–≤–æ–Ω</button>
        <div>
          <input type="number" id="input-reached" />
          <button onclick="applyInput('reached')">–í–≤–æ–¥</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div>ü§ù –í—Å—Ç—Ä–µ—á–∏: <span id="meetings">0</span></div>
      <div class="buttons">
        <button onclick="change('meetings', 1)">+ –í—Å—Ç—Ä–µ—á–∞</button>
        <button onclick="change('meetings', -1)">‚Äì –í—Å—Ç—Ä–µ—á–∞</button>
        <div>
          <input type="number" id="input-meetings" />
          <button onclick="applyInput('meetings')">–í–≤–æ–¥</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div>üìÖ –ù–∞–∑–Ω–∞—á–µ–Ω–æ: <span id="scheduled">0</span></div>
      <div class="buttons">
        <button onclick="change('scheduled', 1)">+ –ù–∞–∑–Ω–∞—á–µ–Ω–æ</button>
        <button onclick="change('scheduled', -1)">‚Äì –ù–∞–∑–Ω–∞—á–µ–Ω–æ</button>
        <div>
          <input type="number" id="input-scheduled" />
          <button onclick="applyInput('scheduled')">–í–≤–æ–¥</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div>üìù –ù–∞–∑–Ω–∞—á–µ–Ω–æ –ö–ü: <span id="kpset">0</span></div>
      <div class="buttons">
        <button onclick="change('kpset', 1)">+ –ù–∞–∑–Ω–∞—á–µ–Ω–æ</button>
        <button onclick="change('kpset', -1)">‚Äì –ù–∞–∑–Ω–∞—á–µ–Ω–æ</button>
        <div>
          <input type="number" id="input-kpset" />
          <button onclick="applyInput('kpset')">–í–≤–æ–¥</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div>üì® –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –ö–ü: <span id="kpsent">0</span></div>
      <div class="buttons">
        <button onclick="change('kpsent', 1)">+ –ü—Ä–æ–≤–µ–¥–µ–Ω–æ</button>
        <button onclick="change('kpsent', -1)">‚Äì –ü—Ä–æ–≤–µ–¥–µ–Ω–æ</button>
        <div>
          <input type="number" id="input-kpsent" />
          <button onclick="applyInput('kpsent')">–í–≤–æ–¥</button>
        </div>
      </div>
    </div>

    <canvas id="progressChart" height="120"></canvas>
  </div>

  <div id="analyticsTab" style="display:none;">
    <p>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å –ø–æ–∑–∂–µ.</p>
  </div>

<script>
let data = {
  calls: 0, reached: 0, meetings: 0,
  scheduled: 0, kpset: 0, kpsent: 0,
  callsGoal: 70, reachedGoal: 25
};

function change(metric, delta) {
  if (!(metric in data)) return;
  data[metric] = Math.max(0, data[metric] + delta);
  adjustGoals();
  update();
}

function applyInput(metric) {
  const el = document.getElementById("input-" + metric);
  const val = parseInt(el.value);
  if (!isNaN(val)) {
    data[metric] = Math.max(0, val);
    adjustGoals();
    update();
  }
}

function adjustGoals() {
  if (data.meetings >= 3) {
    data.callsGoal = 30; data.reachedGoal = 10;
  } else if (data.meetings === 2) {
    data.callsGoal = 50; data.reachedGoal = 15;
  } else if (data.meetings === 1) {
    data.callsGoal = 60; data.reachedGoal = 20;
  } else {
    data.callsGoal = 70; data.reachedGoal = 25;
  }
}

function update() {
  ["calls", "reached", "meetings", "scheduled", "kpset", "kpsent", "callsGoal", "reachedGoal"].forEach(key => {
    document.getElementById(key).textContent = data[key];
  });
  if (window.chart) {
    chart.data.datasets[0].data = [data.calls, data.reached, data.meetings, data.scheduled, data.kpset, data.kpsent];
    chart.update();
  }
}

function showTab(tab) {
  document.getElementById("mainTab").style.display = (tab === "main" ? "block" : "none");
  document.getElementById("analyticsTab").style.display = (tab === "analytics" ? "block" : "none");
}

const ctx = document.getElementById("progressChart").getContext("2d");
window.chart = new Chart(ctx, {
  type: "bar",
  data: {
    labels: ["–ó–≤–æ–Ω–∫–∏", "–î–æ–∑–≤–æ–Ω—ã", "–í—Å—Ç—Ä–µ—á–∏", "–ù–∞–∑–Ω–∞—á–µ–Ω–æ", "–ö–ü –ù–∞–∑–Ω–∞—á–µ–Ω–æ", "–ö–ü –ü—Ä–æ–≤–µ–¥–µ–Ω–æ"],
    datasets: [{
      label: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã",
      data: [0, 0, 0, 0, 0, 0],
      backgroundColor: "#933DC9"
    }]
  },
  options: { responsive: true }
});

document.getElementById("username").textContent = localStorage.getItem("userName") || "–ì–æ—Å—Ç—å";
update();
</script>
</body>
</html>
